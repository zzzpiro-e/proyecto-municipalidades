{% extends 'core/base.html' %}
{% load static %}
{% block title %}Crear Registro de Trabajo{% endblock %}
{% block content %}

<div class="container-fluid">

    <h4 class="text-secondary mb-3">Registrar Trabajo de Incidencia</h4>
    <hr>

    <form method="POST" action="{% url 'crear_registro' %}" enctype="multipart/form-data" class="row g-3">
        {% csrf_token %}

        <!-- Selección de incidencia -->
        <div class="col-md-6">
            <label for="incidencia" class="form-label">Incidencia resuelta:</label>
            <select name="incidencia" id="incidencia" class="form-select" required>
                <option value="">Seleccione una incidencia...</option>
                {% for incidencia in incidencias %}
                <option value="{{ incidencia.id }}">
                    {{ incidencia.titulo }} - {{ incidencia.ubicacion }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-6">
            <label for="fecha" class="form-label">Fecha del trabajo:</label>
            <input type="text"
                   id="fecha"
                   class="form-control"
                   value="{% now 'Y-m-d H:i' %}"
                   disabled>
        </div>

        <!-- Descripción -->
        <div class="col-12 mt-3">
            <label for="descripcion" class="form-label">Descripción del trabajo realizado:</label>
            <textarea name="descripcion" id="descripcion" class="form-control" rows="4"
                placeholder="Detalle las acciones realizadas..." required></textarea>
        </div>

        <hr class="my-3">

        <!-- Subida de archivos -->
        <div class="col-12">
            <label for="archivos" class="form-label">Subir Multimedia (Imágenes / Videos / Audio):</label>
            <input class="form-control" type="file" name="archivos" id="archivos" multiple>
        </div>

        <!-- Botones -->
        <div class="col-12 mt-4">
            <button type="submit" class="btn btn-primary">Guardar registro</button>
            
            <a class="btn btn-outline-secondary" href="{% url 'main_cuadrilla' %}">Menú Principal</a>
            
        </div>

    </form>
</div>

{% if messages %}
<div class="alert alert-info mt-3">
    <ul class="mb-0">
        {% for message in messages %}
            <li>{{ message }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

{% endblock %}
