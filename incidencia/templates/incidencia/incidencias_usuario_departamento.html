{% extends 'core/base.html' %}
{% load static %}
{% block title %}{% endblock %}
{% block content %}

<h4>Incidencias Asignadas a: {{ departamento.nombre_departamento }}</h4>
<hr/>

<!-- üî• Filtro por estado -->
<form method="get" class="mb-3">
    <label><strong>Filtrar por estado:</strong></label>
    <select name="estado" onchange="this.form.submit()" class="form-select" style="max-width: 250px; display:inline-block;">
        <option value="Todos" {% if estado_actual == "Todos" %}selected{% endif %}>Todos</option>
        <option value="Pendiente" {% if estado_actual == "Pendiente" %}selected{% endif %}>Pendiente</option>
        <option value="Asignada" {% if estado_actual == "Asignada" %}selected{% endif %}>Asignada</option>
        <option value="Resuelto" {% if estado_actual == "Resuelto" %}selected{% endif %}>Resuelto</option>
    </select>
</form>

<div class="table-responsive">
    <table class="table table-striped table-hover align-middle text-center">
        <thead class="table-dark">
            <tr>
                <th scope="col">T√≠tulo</th>
                <th scope="col">Tipo</th>
                <th scope="col">Ubicaci√≥n</th>
                <th scope="col">Estado</th>
            </tr>
        </thead>
        <tbody>
        {% for inc in incidencias %}
            <tr>
                <td>{{ inc.titulo }}</td>
                <td>{{ inc.tipo }}</td>
                <td>{{ inc.ubicacion }}</td>
                <td>{{ inc.estado }}</td>
            </tr>
        {% empty %}
            <tr><td colspan="5">No tienes incidencias con este filtro.</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>

{% if messages %}
    <ul>
    {% for message in messages %}
        <li style="color: green;">{{ message }}</li>
    {% endfor %}
    </ul>
{% endif %}

<br/>
<a href="{% url 'main_departamento' %}">Volver al men√∫</a>

{% endblock %}

